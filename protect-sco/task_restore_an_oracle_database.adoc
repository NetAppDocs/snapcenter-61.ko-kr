---
permalink: protect-sco/task_restore_an_oracle_database.html 
sidebar: sidebar 
keywords: restore, recover, Oracle 
summary: 데이터 손실이 발생한 경우 SnapCenter 사용하여 하나 이상의 백업에서 데이터를 활성 파일 시스템으로 복원한 다음 데이터베이스를 복구할 수 있습니다. 
---
= Oracle 데이터베이스 복원 및 복구
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
데이터 손실이 발생한 경우 SnapCenter 사용하여 하나 이상의 백업에서 데이터를 활성 파일 시스템으로 복원한 다음 데이터베이스를 복구할 수 있습니다.

*시작하기 전에*

루트가 아닌 사용자로 플러그인을 설치한 경우, prescript 및 postscript 디렉토리에 대한 실행 권한을 수동으로 할당해야 합니다.

*이 작업에 관하여*

* 복구는 구성된 보관 로그 위치에서 사용 가능한 보관 로그를 사용하여 수행됩니다.  데이터베이스가 ARCHIVELOG 모드로 실행 중인 경우 Oracle 데이터베이스는 채워진 리두 로그 파일 그룹을 하나 이상의 오프라인 대상에 저장합니다. 이를 통칭하여 보관된 리두 로그라고 합니다.  SnapCenter 지정된 SCN, 선택한 날짜 및 시간 또는 모든 로그 옵션을 기반으로 최적의 로그 백업 수를 식별하고 마운트합니다.  복구에 필요한 보관 로그를 구성된 위치에서 사용할 수 없는 경우 로그가 포함된 스냅샷을 마운트하고 경로를 외부 보관 로그로 지정해야 합니다.
+
ASMLIB에서 ASMFD로 ASM 데이터베이스를 마이그레이션하는 경우 ASMLIB로 생성된 백업을 사용하여 데이터베이스를 복원할 수 없습니다.  ASMFD 구성에서 백업을 생성하고 해당 백업을 사용하여 복원해야 합니다.  마찬가지로 ASM 데이터베이스가 ASMFD에서 ASMLIB로 마이그레이션된 경우 ASMLIB 구성에서 백업을 생성하여 복원해야 합니다.

+
데이터베이스를 복원하면 여러 작업이 데이터베이스에서 실행되는 것을 방지하기 위해 Oracle 데이터베이스 호스트의 _/var/opt/snapcenter/sco/lock_ 디렉토리에 작업 잠금 파일(.sm_lock_dbsid)이 생성됩니다.  데이터베이스가 복구되면 운영 잠금 파일이 자동으로 제거됩니다.

+

NOTE: SPFILE 및 비밀번호 파일 복원은 지원되지 않습니다.

* SnapLock 활성화된 정책의 경우 ONTAP 9.12.1 이하 버전에서 스냅샷 잠금 기간을 지정하면 복원의 일부로 변조 방지 스냅샷에서 생성된 복제본은 SnapLock 만료 시간을 상속받습니다. 스토리지 관리자는 SnapLock 만료 시간 이후에 복제본을 수동으로 정리해야 합니다.


*단계*

. 왼쪽 탐색 창에서 *리소스*를 클릭한 다음 목록에서 적절한 플러그인을 선택합니다.
. 리소스 페이지에서 *보기* 목록에서 *데이터베이스* 또는 *리소스 그룹*을 선택합니다.
. 데이터베이스 세부 정보 보기 또는 리소스 그룹 세부 정보 보기에서 데이터베이스를 선택합니다.
+
데이터베이스 토폴로지 페이지가 표시됩니다.

. 복사본 관리 보기에서 기본 또는 보조(미러링 또는 복제) 스토리지 시스템의 *백업*을 선택합니다.
. 테이블에서 백업을 선택한 후 *를 클릭합니다.image:../media/restore_icon.gif["복원 아이콘"] *.
. 복원 범위 페이지에서 다음 작업을 수행합니다.
+
.. RAC(Real Application Clusters) 환경에서 데이터베이스 백업을 선택한 경우 RAC 노드를 선택합니다.
.. 미러링 또는 볼트 데이터를 선택하는 경우:
+
*** 미러 또는 볼트에 로그 백업이 없으면 아무것도 선택되지 않고 로케이터는 비어 있습니다.
*** 미러 또는 볼트에 로그 백업이 있는 경우 최신 로그 백업이 선택되고 해당 로케이터가 표시됩니다.
+

NOTE: 선택한 로그 백업이 미러와 볼트 위치에 모두 있는 경우 두 로케이터가 모두 표시됩니다.



.. 다음 작업을 수행하세요.
+
|===
| 복원하고 싶다면... | 이렇게 하세요... 


 a| 
데이터베이스의 모든 데이터 파일
 a| 
*모든 데이터 파일*을 선택합니다.

데이터베이스의 데이터 파일만 복원됩니다.  제어 파일, 보관 로그 또는 리두 로그 파일은 복원되지 않습니다.



 a| 
테이블스페이스
 a| 
*테이블스페이스*를 선택합니다.

복원할 테이블스페이스를 지정할 수 있습니다.



 a| 
제어 파일
 a| 
*제어 파일*을 선택합니다.


NOTE: 제어 파일을 복원하는 동안 디렉토리 구조가 존재하는지 또는 복원 프로세스를 통해 파일을 대상 위치로 복사할 수 있도록 올바른 사용자 및 그룹 소유권(있는 경우)으로 디렉토리 구조가 생성되었는지 확인합니다.  해당 디렉토리가 존재하지 않으면 복원 작업이 실패합니다.



 a| 
리두 로그 파일
 a| 
*Redo 로그 파일*을 선택합니다.

이 옵션은 Data Guard 대기 또는 Active Data Guard 대기 데이터베이스에만 사용할 수 있습니다.


NOTE: Data Guard 데이터베이스가 아닌 경우에는 Redo 로그 파일이 백업되지 않습니다.  Data Guard 데이터베이스가 아닌 경우 복구는 보관 로그를 사용하여 수행됩니다.



 a| 
플러그형 데이터베이스(PDB)
 a| 
*플러그형 데이터베이스*를 선택한 다음 복원하려는 PDB를 지정합니다.



 a| 
플러그형 데이터베이스(PDB) 테이블스페이스
 a| 
*플러그형 데이터베이스(PDB) 테이블스페이스*를 선택한 다음 복원하려는 PDB와 해당 PDB의 테이블스페이스를 지정합니다.

이 옵션은 복원할 PDB를 선택한 경우에만 사용할 수 있습니다.

|===
.. 복원 및 복구에 필요한 경우 데이터베이스 상태 변경을 선택하여 복원 및 복구 작업을 수행하는 데 필요한 상태로 데이터베이스 상태를 변경합니다.
+
데이터베이스의 다양한 상태는 높은 것부터 낮은 것까지 있으며, 여기에는 열기, 마운트됨, 시작됨, 종료가 있습니다.  데이터베이스가 상위 상태에 있지만 복원 작업을 수행하기 위해 상태를 하위 상태로 변경해야 하는 경우 이 확인란을 선택해야 합니다.  데이터베이스가 하위 상태에 있지만 복원 작업을 수행하기 위해 상태를 상위 상태로 변경해야 하는 경우, 확인란을 선택하지 않더라도 데이터베이스 상태가 자동으로 변경됩니다.

+
데이터베이스가 열린 상태이고 복원을 위해 데이터베이스를 마운트된 상태로 유지해야 하는 경우, 이 확인란을 선택한 경우에만 데이터베이스 상태가 변경됩니다.

.. 백업 후 새 데이터 파일이 추가되거나 LUN이 LVM 디스크 그룹에 추가, 삭제 또는 다시 생성되는 경우 제자리 복원을 수행하려면 *강제 제자리 복원*을 선택합니다.


. 복구 범위 페이지에서 다음 작업을 수행합니다.
+
|===
| 만약 당신이... | 이렇게 하세요... 


 a| 
마지막 거래로 복구하고 싶습니다
 a| 
*모든 로그*를 선택하세요.



 a| 
특정 시스템 변경 번호(SCN)로 복구하려고 합니다.
 a| 
*SCN(시스템 변경 번호)까지*를 선택하세요.



 a| 
특정 데이터 및 시간으로 복구하고 싶습니다
 a| 
*날짜 및 시간*을 선택하세요.

데이터베이스 호스트의 표준 시간대에 따른 날짜와 시간을 지정해야 합니다.



 a| 
복구하고 싶지 않아요
 a| 
*복구 안 함*을 선택하세요.



 a| 
외부 보관 로그 위치를 지정하려고 합니다.
 a| 
데이터베이스가 ARCHIVELOG 모드에서 실행되는 경우 SnapCenter 지정된 SCN, 선택한 날짜 및 시간 또는 모든 로그 옵션을 기반으로 최적의 로그 백업 수를 식별하고 마운트합니다.

외부 보관 로그 파일의 위치를 지정하려면 *외부 보관 로그 위치 지정*을 선택하세요.

백업의 일부로 보관 로그가 정리되고 필요한 보관 로그 백업을 수동으로 마운트한 경우, 복구를 위해 마운트된 백업 경로를 외부 보관 로그 위치로 지정해야 합니다.


NOTE: 외부 로그 위치로 나열하기 전에 마운트 경로의 경로와 내용을 확인해야 합니다.

** https://docs.netapp.com/us-en/ontap-apps-dbs/oracle/oracle-dp-overview.html["ONTAP 통한 Oracle 데이터 보호"^]
** https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/ORA-00308%3A_cannot_open_archived_log_ORA_LOG_arch1_123_456789012.arc["ORA-00308 오류로 인해 작업이 실패합니다."^]


|===
+
보관 로그 볼륨이 보호되지 않았지만 데이터 볼륨이 보호된 경우 보조 백업에서 복구를 통해 복원을 수행할 수 없습니다.  *복구 안 함*을 선택해야만 복원이 가능합니다.

+
열린 데이터베이스 옵션을 선택하여 RAC 데이터베이스를 복구하는 경우 복구 작업이 시작된 RAC 인스턴스만 열린 상태로 돌아갑니다.

+

NOTE: Data Guard 대기 및 Active Data Guard 대기 데이터베이스에는 복구가 지원되지 않습니다.

. PreOps 페이지에서 복원 작업 전에 실행할 사전 스크립트의 경로와 인수를 입력합니다.
+
사전 스크립트는 _/var/opt/snapcenter/spl/scripts_ 경로나 이 경로 내부의 폴더에 저장해야 합니다.  기본적으로 _/var/opt/snapcenter/spl/scripts_ 경로가 채워집니다.  이 경로 내에 스크립트를 저장하기 위한 폴더를 만든 경우 경로에 해당 폴더를 지정해야 합니다.

+
스크립트 시간 초과 값을 지정할 수도 있습니다. 기본값은 60초입니다.

+
SnapCenter 사용하면 프리스크립트와 포스트스크립트를 실행할 때 미리 정의된 환경 변수를 사용할 수 있습니다.link:../protect-sco/predefined-environment-variables-prescript-postscript-restore.html["자세히 알아보기"^]

. PostOps 페이지에서 다음 단계를 수행하세요.
+
.. 복원 작업 후 실행할 PostScript의 경로와 인수를 입력합니다.
+
포스트스크립트는 _/var/opt/snapcenter/spl/scripts_ 또는 이 경로 내부의 폴더에 저장해야 합니다.  기본적으로 _/var/opt/snapcenter/spl/scripts_ 경로가 채워집니다.  이 경로 내에 스크립트를 저장하기 위한 폴더를 만든 경우 경로에 해당 폴더를 지정해야 합니다.

+

NOTE: 복원 작업이 실패하면 포스트스크립트가 실행되지 않고 정리 작업이 직접 시작됩니다.

.. 복구 후 데이터베이스를 열려면 확인란을 선택하세요.
+
제어 파일이 있거나 없는 컨테이너 데이터베이스(CDB)를 복원한 후, 또는 CDB 제어 파일만 복원한 후 복구 후에 데이터베이스를 열도록 지정하면 해당 CDB에 있는 플러그형 데이터베이스(PDB)는 열리지 않고 CDB만 열립니다.

+
RAC 설정에서는 복구에 사용된 RAC 인스턴스만 복구 후에 열립니다.

+

NOTE: 제어 파일이 있는 사용자 테이블스페이스, 제어 파일이 있거나 없는 시스템 테이블스페이스, 제어 파일이 있거나 없는 PDB를 복원한 후에는 복원 작업과 관련된 PDB의 상태만 원래 상태로 변경됩니다.  복원에 사용되지 않은 다른 PDB의 상태는 해당 PDB의 상태가 저장되지 않았기 때문에 원래 상태로 변경되지 않습니다.  복원에 사용되지 않은 PDB의 상태를 수동으로 변경해야 합니다.



. 알림 페이지의 *이메일 환경 설정* 드롭다운 목록에서 이메일 알림을 보낼 시나리오를 선택합니다.
+
또한 발신자와 수신자의 이메일 주소와 이메일 제목을 지정해야 합니다.  수행된 복구 작업 보고서를 첨부하려면 *작업 보고서 첨부*를 선택해야 합니다.

+

NOTE: 이메일 알림을 받으려면 GUI 또는 PowerShell 명령 Set-SmSmtpServer를 사용하여 SMTP 서버 세부 정보를 지정해야 합니다.

. 요약을 검토한 후 *마침*을 클릭하세요.
. *모니터* > *작업*을 클릭하여 작업 진행 상황을 모니터링하세요.


*자세한 내용은*

* https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/Oracle_RAC_One_Node_database_is_skipped_for_performing_SnapCenter_operations["SnapCenter 작업을 수행하기 위해 Oracle RAC One Node 데이터베이스가 건너뜁니다."^]
* https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/Failed_to_restore_from_a_secondary_SnapMirror_or_SnapVault_location["보조 SnapMirror 또는 SnapVault 위치에서 복원하지 못했습니다."^]
* https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/Failed_to_restore_when_a_backup_of_an_orphan_incarnation_is_selected["고아 화신의 백업에서 복원에 실패했습니다."^]
* https://kb.netapp.com/Advice_and_Troubleshooting/Data_Protection_and_Security/SnapCenter/What_are_the_customizable_parameters_for_backup_restore_and_clone_operations_on_AIX_systems["AIX 시스템의 백업, 복원 및 복제 작업을 위한 사용자 정의 가능한 매개변수"^]

